<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Froggy Quest</title>
    <style>
        body { background: #1a5276; color: white; font-family: sans-serif; text-align: center; margin: 0; overflow: hidden; }
        #game-container { display: none; width: 100vw; height: 100vh; position: relative; }
        #status { display: flex; align-items: center; justify-content: center; height: 100vh; font-size: 24px; }
        .frog { transition: all 0.5s; position: absolute; z-index: 10; }
        .shock { animation: shake 0.2s infinite; filter: contrast(2) sepia(1) hue-rotate(150deg); }
        @keyframes shake { 0% { transform: translate(2px, 2px); } 50% { transform: translate(-2px, -2px); } 100% { transform: translate(2px, -2px); } }
    </style>
</head>
<body>
    <div id="status">–ó–∞–≥—Ä—É–∑–∫–∞ –∏–≥—Ä—ã...</div>
    <div id="game-container">
        <div id="lives">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</div>
        <div id="question-box"></div>
        <div id="frog" class="frog">üê∏</div>
    </div>

<script>
// –ó–ê–©–ò–¢–ê –ò –°–ö–†–´–¢–ò–ï –ì–ò–¢–•–ê–ë–ê
if (window.self === window.top && !window.location.href.includes('localhost')) {
    document.body.innerHTML = "<h1>–î–æ—Å—Ç—É–ø –æ–≥—Ä–∞–Ω–∏—á–µ–Ω</h1>";
    throw new Error("Direct access denied");
}

let gameConfig = null;

async function loadData() {
    const params = new URLSearchParams(window.location.search);
    const id = params.get('id');
    const url = `https://vera422.github.io/texts/data/${id}.json`;

    try {
        const response = await fetch(url);
        if (response.status === 404) {
            document.getElementById('status').textContent = "–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º (30 —Å–µ–∫)...";
            setTimeout(loadData, 5000);
            return;
        }
        gameConfig = await response.json();
        setupGame();
    } catch (e) {
        document.getElementById('status').textContent = "–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏";
    }
}

function setupGame() {
    document.getElementById('status').style.display = 'none';
    document.getElementById('game-container').style.display = 'block';
    console.log("–ò–≥—Ä–∞ –≥–æ—Ç–æ–≤–∞:", gameConfig.title);
    // –ó–¥–µ—Å—å –≤—ã–∑—ã–≤–∞—é—Ç—Å—è —Ç–≤–æ–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ —É—Ä–æ–≤–Ω–µ–π
}

// –ü–†–ê–í–ò–õ–û: –®–æ–∫ –ª—è–≥—É—à–∫–∏ –ø—Ä–∏ –Ω–µ–≤–µ—Ä–Ω–æ–º –æ—Ç–≤–µ—Ç–µ
function onWrongAnswer() {
    const frog = document.getElementById('frog');
    frog.classList.add('shock'); // –í–∏–∑—É–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç —É–¥–∞—Ä–∞ —Ç–æ–∫–æ–º
    const audio = new Audio('https://vera422.github.io/froggy-quest-builder-v3/3.mp3');
    audio.play();
    
    setTimeout(() => {
        frog.classList.remove('shock');
        // –õ—è–≥—É—à–∫–∞ –æ—Ç—Å–∫–∞–∫–∏–≤–∞–µ—Ç –Ω–∞–∑–∞–¥ (—Å–æ–≥–ª–∞—Å–Ω–æ —Ç–≤–æ–∏–º –ø—Ä–∞–≤–∏–ª–∞–º)
        bounceBack(); 
    }, 1000);
}

// –ü–†–ê–í–ò–õ–û: –ó–≤—É–∫ 4.mp3 –≤ –∫–æ–Ω—Ü–µ –∏–≥—Ä—ã
function finishGame() {
    const winAudio = new Audio('https://vera422.github.io/froggy-quest-builder-v3/4.mp3');
    winAudio.play();
    alert("–ü–û–ë–ï–î–ê!");
}

loadData();
</script>
</body>
</html>
