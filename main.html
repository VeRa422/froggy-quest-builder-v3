<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <style>
        body { background: #1a5276; color: white; font-family: sans-serif; margin: 0; overflow: hidden; }
        #status { display: flex; align-items: center; justify-content: center; height: 100vh; font-size: 20px; }
        #game-container { display: none; padding: 20px; }
        .lilypad { width: 100px; height: 60px; background: green; border-radius: 50%; display: inline-block; margin: 20px; cursor: pointer; color: black; line-height: 60px; font-weight: bold; }
        .frog { font-size: 50px; position: absolute; transition: all 0.5s; top: 200px; left: 50px; }
    </style>
</head>
<body>
    <div id="status">–ó–∞–≥—Ä—É–∑–∫–∞ –∏–≥—Ä—ã...</div>
    <div id="game-container">
        <h2 id="quest-title"></h2>
        <div id="question-text" style="font-size: 24px; margin-bottom: 20px;"></div>
        <div id="pads-container"></div>
        <div id="frog" class="frog">üê∏</div>
    </div>

<script>
// 1. –ó–ê–©–ò–¢–ê (–ß—Ç–æ–±—ã –Ω–µ –≤–æ—Ä–æ–≤–∞–ª–∏ –∏ –Ω–µ –≤–∏–¥–µ–ª–∏ –∞–¥—Ä–µ—Å)
if (window.self === window.top && !window.location.href.includes('localhost')) {
    document.body.innerHTML = "<h1>–î–æ—Å—Ç—É–ø –æ–≥—Ä–∞–Ω–∏—á–µ–Ω. –û—Ç–∫—Ä–æ–π—Ç–µ –∏–≥—Ä—É —á–µ—Ä–µ–∑ Genially.</h1>";
    throw new Error("Access denied");
}

let gameData = null;

// 2. –ó–ê–ì–†–£–ó–ö–ê (–ñ–¥–µ–º —Ñ–∞–π–ª –æ—Ç GitHub)
async function loadGame() {
    const id = new URLSearchParams(window.location.search).get('id');
    try {
        const res = await fetch(`https://vera422.github.io/texts/data/${id}.json`);
        if (res.status === 404) {
            document.getElementById('status').textContent = "–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è... (–ø–æ–¥–æ–∂–¥–∏—Ç–µ 30 —Å–µ–∫—É–Ω–¥)";
            setTimeout(loadGame, 5000);
            return;
        }
        gameData = await res.json();
        start();
    } catch (e) { document.getElementById('status').textContent = "–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏"; }
}

// 3. –ó–ê–ü–£–°–ö –ò–ì–†–´
function start() {
    document.getElementById('status').style.display = 'none';
    document.getElementById('game-container').style.display = 'block';
    document.getElementById('quest-title').textContent = gameData.title;
    
    showLevel(0);
}

function showLevel(index) {
    const level = gameData.levels[index];
    document.getElementById('question-text').textContent = level.question;
    const container = document.getElementById('pads-container');
    container.innerHTML = '';

    level.answers.forEach(ans => {
        const pad = document.createElement('div');
        pad.className = 'lilypad';
        pad.textContent = ans.text;
        pad.onclick = () => check(ans.correct);
        container.appendChild(pad);
    });
}

function check(isCorrect) {
    if(isCorrect) {
        new Audio('https://vera422.github.io/froggy-quest-builder-v3/2.mp3').play();
        alert("–ü—Ä–∞–≤–∏–ª—å–Ω–æ! –ö–≤–∞!");
        // –¢—É—Ç –±—É–¥–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —É—Ä–æ–≤–Ω—é
    } else {
        // –¢–í–û–ï –ü–†–ê–í–ò–õ–û: –®–æ–∫ –∏ –æ—Ç—Å–∫–æ–∫
        const frog = document.getElementById('frog');
        frog.style.transform = "scale(1.2)";
        new Audio('https://vera422.github.io/froggy-quest-builder-v3/3.mp3').play();
        setTimeout(() => { 
            frog.style.transform = "scale(1)";
            alert("–û–π! –¢–æ–∫–æ–º —É–¥–∞—Ä–∏–ª–æ! –ü–æ–ø—Ä–æ–±—É–π –µ—â–µ —Ä–∞–∑.");
        }, 500);
    }
}

loadGame();
</script>
</body>
</html>
